# reb -- Regular Expression Beautiful

reb 的目标是让信息抽取任务的正则更容易编写、维护，从而整个团队能写出规模更大的信息抽取模式。

和标准库里的 re 相比，reb 在这几方面作出改进: 

+ 可维护性 -- 用例子来辅助正则的编写和维护
+ 可重用性 -- 定义一次、多次使用
+ 易用性 -- 一次匹配提出多组同名片段

---

## 自然语言中的模式

自然语言中的模式是相对松散、不严格的；是基于数据集总结出来的，而不像那样 ip地址、url 有严格定义的标准格式。

为了涵盖多种表达方式，一个信息抽取任务考虑到五六种子模式是比较常见的。

## 引入例子

既然有五六种子模式，回看每个正则式时常常会很困惑，忘记了当初为什么要补充这个这个子模式。

正则不太直观，一眼看上去，不能想到哪些能匹配。

给复杂的正则式配上若干例子，有助于理解当初这个模式是怎么总结出来的。修改、维护也就更容易了。

## 用例子检测模式冲突

五六种子模式带来的另一个维护上的挑战是，模式之间有冲突。

假如代码库里现有的五个模式有 bad case，增加一个覆盖该 bad case 的新模式未必提升指标。因为以前匹配良好的情况遇到新模式反而出错，整体上拉低指标。

这种情况，就是新模式和现有模式发生了冲突。

糟糕的是，有些时候即使冲突发生，编写模式的人也未必知道。

通过引入例子，可以降低冲突发生的可能性。至少冲突发生时我们可以知道。

如果一个例子在单个子模式上的匹配结果和整体上不一样，说明有某些子模式互相冲突了。

维护模式的人可以相应调整这些模式，调整这些例子，化解这些冲突。

## 可以共用的模式

模式复杂了之后，有一个重要的诉求 -- 重用模式。

一个完整的匹配时间日期的正则式需要数十个字符。假设几个子模式中都出现时间日期，那么每次都必须重复这数十个字符。整个正则式会变得特别长，很难读。

理想的方式是，匹配日期的模式只写一次；用到它时，只要说明“这里要匹配一个日期”，模式会表达得简洁明了。

## 多个同名片段

re 支持给一个组命名，可以通过组名把该组对应的片段提取出来。这是一个非常有用的功能，比如匹配了日期之后，需要知道哪些字符对应年、哪些对应月。

但这个功能有一个限制，表达式中不能出现同名的组。假设匹配了一句话里面有多个“地点”，做不到把所有的“地点”片段都拿出来。

reb 尝试在以上方面做出改进。

